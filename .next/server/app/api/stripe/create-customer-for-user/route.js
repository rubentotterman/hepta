"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/stripe/create-customer-for-user/route";
exports.ids = ["app/api/stripe/create-customer-for-user/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&page=%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute.ts&appDir=%2Fhome%2Fruben%2Fcode%2Fhepta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fruben%2Fcode%2Fhepta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&page=%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute.ts&appDir=%2Fhome%2Fruben%2Fcode%2Fhepta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fruben%2Fcode%2Fhepta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_ruben_code_hepta_app_api_stripe_create_customer_for_user_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/stripe/create-customer-for-user/route.ts */ \"(rsc)/./app/api/stripe/create-customer-for-user/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/stripe/create-customer-for-user/route\",\n        pathname: \"/api/stripe/create-customer-for-user\",\n        filename: \"route\",\n        bundlePath: \"app/api/stripe/create-customer-for-user/route\"\n    },\n    resolvedPagePath: \"/home/ruben/code/hepta/app/api/stripe/create-customer-for-user/route.ts\",\n    nextConfigOutput,\n    userland: _home_ruben_code_hepta_app_api_stripe_create_customer_for_user_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/stripe/create-customer-for-user/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdHJpcGUlMkZjcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN0cmlwZSUyRmNyZWF0ZS1jdXN0b21lci1mb3ItdXNlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN0cmlwZSUyRmNyZWF0ZS1jdXN0b21lci1mb3ItdXNlciUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGcnViZW4lMkZjb2RlJTJGaGVwdGElMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZydWJlbiUyRmNvZGUlMkZoZXB0YSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDdUI7QUFDcEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oZXB0YS1kYXNoYm9hcmQvPzFhMzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvcnViZW4vY29kZS9oZXB0YS9hcHAvYXBpL3N0cmlwZS9jcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N0cmlwZS9jcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zdHJpcGUvY3JlYXRlLWN1c3RvbWVyLWZvci11c2VyXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zdHJpcGUvY3JlYXRlLWN1c3RvbWVyLWZvci11c2VyL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvcnViZW4vY29kZS9oZXB0YS9hcHAvYXBpL3N0cmlwZS9jcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3N0cmlwZS9jcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&page=%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute.ts&appDir=%2Fhome%2Fruben%2Fcode%2Fhepta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fruben%2Fcode%2Fhepta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/stripe/create-customer-for-user/route.ts":
/*!**********************************************************!*\
  !*** ./app/api/stripe/create-customer-for-user/route.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/auth-helpers-nextjs */ \"(rsc)/./node_modules/@supabase/auth-helpers-nextjs/dist/index.js\");\n/* harmony import */ var _supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_stripe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/stripe */ \"(rsc)/./lib/stripe.ts\");\n\n\n\n\nasync function POST(req) {\n    try {\n        const { userId, email, name } = await req.json();\n        if (!userId || !email) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User ID and email are required\"\n            }, {\n                status: 400\n            });\n        }\n        const supabase = (0,_supabase_auth_helpers_nextjs__WEBPACK_IMPORTED_MODULE_1__.createRouteHandlerClient)({\n            cookies: next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies\n        });\n        // Check if the user already has a customer ID\n        const { data: profile, error: profileError } = await supabase.from(\"profiles\").select(\"stripe_customer_id\").eq(\"id\", userId).single();\n        if (profileError && profileError.code !== \"PGRST116\") {\n            console.error(\"Error fetching profile:\", profileError);\n            throw profileError;\n        }\n        // If the user already has a customer ID, return it\n        if (profile?.stripe_customer_id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                customerId: profile.stripe_customer_id\n            });\n        }\n        // Create a new Stripe customer\n        const customer = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_3__.createCustomer)(email, name);\n        // Save the customer ID to the user's profile\n        const { error: updateError } = await supabase.from(\"profiles\").upsert({\n            id: userId,\n            stripe_customer_id: customer.id,\n            updated_at: new Date().toISOString()\n        });\n        if (updateError) {\n            console.error(\"Error saving customer ID to profile:\", updateError);\n            throw updateError;\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            customerId: customer.id\n        });\n    } catch (error) {\n        console.error(\"Error creating Stripe customer:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: `Failed to create Stripe customer: ${error instanceof Error ? error.message : String(error)}`\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N0cmlwZS9jcmVhdGUtY3VzdG9tZXItZm9yLXVzZXIvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBDO0FBQzhCO0FBQ2xDO0FBQ087QUFFdEMsZUFBZUksS0FBS0MsR0FBWTtJQUNyQyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxNQUFNLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxFQUFFLEdBQUcsTUFBTUgsSUFBSUksSUFBSTtRQUU5QyxJQUFJLENBQUNILFVBQVUsQ0FBQ0MsT0FBTztZQUNyQixPQUFPUCxxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWlDLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUN0RjtRQUVBLE1BQU1DLFdBQVdYLHVGQUF3QkEsQ0FBQztZQUFFQyxPQUFPQSxtREFBQUE7UUFBQztRQUVwRCw4Q0FBOEM7UUFDOUMsTUFBTSxFQUFFVyxNQUFNQyxPQUFPLEVBQUVKLE9BQU9LLFlBQVksRUFBRSxHQUFHLE1BQU1ILFNBQ2xESSxJQUFJLENBQUMsWUFDTEMsTUFBTSxDQUFDLHNCQUNQQyxFQUFFLENBQUMsTUFBTVosUUFDVGEsTUFBTTtRQUVULElBQUlKLGdCQUFnQkEsYUFBYUssSUFBSSxLQUFLLFlBQVk7WUFDcERDLFFBQVFYLEtBQUssQ0FBQywyQkFBMkJLO1lBQ3pDLE1BQU1BO1FBQ1I7UUFFQSxtREFBbUQ7UUFDbkQsSUFBSUQsU0FBU1Esb0JBQW9CO1lBQy9CLE9BQU90QixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO2dCQUFFYyxZQUFZVCxRQUFRUSxrQkFBa0I7WUFBQztRQUNwRTtRQUVBLCtCQUErQjtRQUMvQixNQUFNRSxXQUFXLE1BQU1yQiwyREFBY0EsQ0FBQ0ksT0FBT0M7UUFFN0MsNkNBQTZDO1FBQzdDLE1BQU0sRUFBRUUsT0FBT2UsV0FBVyxFQUFFLEdBQUcsTUFBTWIsU0FBU0ksSUFBSSxDQUFDLFlBQVlVLE1BQU0sQ0FBQztZQUNwRUMsSUFBSXJCO1lBQ0pnQixvQkFBb0JFLFNBQVNHLEVBQUU7WUFDL0JDLFlBQVksSUFBSUMsT0FBT0MsV0FBVztRQUNwQztRQUVBLElBQUlMLGFBQWE7WUFDZkosUUFBUVgsS0FBSyxDQUFDLHdDQUF3Q2U7WUFDdEQsTUFBTUE7UUFDUjtRQUVBLE9BQU96QixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQUVjLFlBQVlDLFNBQVNHLEVBQUU7UUFBQztJQUNyRCxFQUFFLE9BQU9qQixPQUFPO1FBQ2RXLFFBQVFYLEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE9BQU9WLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQUVDLE9BQU8sQ0FBQyxrQ0FBa0MsRUFBRUEsaUJBQWlCcUIsUUFBUXJCLE1BQU1zQixPQUFPLEdBQUdDLE9BQU92QixPQUFPLENBQUM7UUFBQyxHQUN2RztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2hlcHRhLWRhc2hib2FyZC8uL2FwcC9hcGkvc3RyaXBlL2NyZWF0ZS1jdXN0b21lci1mb3ItdXNlci9yb3V0ZS50cz80MzIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiXG5pbXBvcnQgeyBjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL2F1dGgtaGVscGVycy1uZXh0anNcIlxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIlxuaW1wb3J0IHsgY3JlYXRlQ3VzdG9tZXIgfSBmcm9tIFwiQC9saWIvc3RyaXBlXCJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyB1c2VySWQsIGVtYWlsLCBuYW1lIH0gPSBhd2FpdCByZXEuanNvbigpXG5cbiAgICBpZiAoIXVzZXJJZCB8fCAhZW1haWwpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlVzZXIgSUQgYW5kIGVtYWlsIGFyZSByZXF1aXJlZFwiIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVJvdXRlSGFuZGxlckNsaWVudCh7IGNvb2tpZXMgfSlcblxuICAgIC8vIENoZWNrIGlmIHRoZSB1c2VyIGFscmVhZHkgaGFzIGEgY3VzdG9tZXIgSURcbiAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yOiBwcm9maWxlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcInByb2ZpbGVzXCIpXG4gICAgICAuc2VsZWN0KFwic3RyaXBlX2N1c3RvbWVyX2lkXCIpXG4gICAgICAuZXEoXCJpZFwiLCB1c2VySWQpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChwcm9maWxlRXJyb3IgJiYgcHJvZmlsZUVycm9yLmNvZGUgIT09IFwiUEdSU1QxMTZcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHByb2ZpbGU6XCIsIHByb2ZpbGVFcnJvcilcbiAgICAgIHRocm93IHByb2ZpbGVFcnJvclxuICAgIH1cblxuICAgIC8vIElmIHRoZSB1c2VyIGFscmVhZHkgaGFzIGEgY3VzdG9tZXIgSUQsIHJldHVybiBpdFxuICAgIGlmIChwcm9maWxlPy5zdHJpcGVfY3VzdG9tZXJfaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGN1c3RvbWVySWQ6IHByb2ZpbGUuc3RyaXBlX2N1c3RvbWVyX2lkIH0pXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGEgbmV3IFN0cmlwZSBjdXN0b21lclxuICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgY3JlYXRlQ3VzdG9tZXIoZW1haWwsIG5hbWUpXG5cbiAgICAvLyBTYXZlIHRoZSBjdXN0b21lciBJRCB0byB0aGUgdXNlcidzIHByb2ZpbGVcbiAgICBjb25zdCB7IGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcInByb2ZpbGVzXCIpLnVwc2VydCh7XG4gICAgICBpZDogdXNlcklkLFxuICAgICAgc3RyaXBlX2N1c3RvbWVyX2lkOiBjdXN0b21lci5pZCxcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9KVxuXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2F2aW5nIGN1c3RvbWVyIElEIHRvIHByb2ZpbGU6XCIsIHVwZGF0ZUVycm9yKVxuICAgICAgdGhyb3cgdXBkYXRlRXJyb3JcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjdXN0b21lcklkOiBjdXN0b21lci5pZCB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBTdHJpcGUgY3VzdG9tZXI6XCIsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGBGYWlsZWQgdG8gY3JlYXRlIFN0cmlwZSBjdXN0b21lcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9LFxuICAgIClcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50IiwiY29va2llcyIsImNyZWF0ZUN1c3RvbWVyIiwiUE9TVCIsInJlcSIsInVzZXJJZCIsImVtYWlsIiwibmFtZSIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInN1cGFiYXNlIiwiZGF0YSIsInByb2ZpbGUiLCJwcm9maWxlRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjb2RlIiwiY29uc29sZSIsInN0cmlwZV9jdXN0b21lcl9pZCIsImN1c3RvbWVySWQiLCJjdXN0b21lciIsInVwZGF0ZUVycm9yIiwidXBzZXJ0IiwiaWQiLCJ1cGRhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiRXJyb3IiLCJtZXNzYWdlIiwiU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/stripe/create-customer-for-user/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stripe.ts":
/*!***********************!*\
  !*** ./lib/stripe.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCustomer: () => (/* binding */ createCustomer),\n/* harmony export */   createInvoice: () => (/* binding */ createInvoice),\n/* harmony export */   createPaymentIntent: () => (/* binding */ createPaymentIntent),\n/* harmony export */   createTestInvoice: () => (/* binding */ createTestInvoice),\n/* harmony export */   formatAmountForStripe: () => (/* binding */ formatAmountForStripe),\n/* harmony export */   formatAmountFromStripe: () => (/* binding */ formatAmountFromStripe),\n/* harmony export */   getCustomerInvoices: () => (/* binding */ getCustomerInvoices),\n/* harmony export */   payInvoice: () => (/* binding */ payInvoice),\n/* harmony export */   stripe: () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n\n// Check if we're in development mode\nconst isDevelopment = \"development\" === \"development\";\n// Initialize Stripe with the provided secret key\n// Use a test key for development and handle missing keys gracefully\nconst getStripeInstance = ()=>{\n    const apiKey = \"sk_test_51NTj6ECBZbubqLlTavZEEYr8YqLtMwVYfzIY8EyT3kXY2yuSv6z7hsiQ2omjZnQ1TMIFee3emq7HIcMAe4rWdAoc00CZhpLtEf\" || 0;\n    if (!apiKey) {\n        console.warn(\"âš ï¸ No Stripe API key found. Using mock data for Stripe operations.\");\n        return null;\n    }\n    // Check if we're trying to use a live key in development\n    if (isDevelopment && apiKey.startsWith(\"sk_live_\")) {\n        console.warn(\"âš ï¸ Using a live Stripe key in development environment. Consider using a test key instead.\");\n    }\n    try {\n        return new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](apiKey, {\n            apiVersion: \"2023-10-16\"\n        });\n    } catch (error) {\n        console.error(\"Failed to initialize Stripe:\", error);\n        return null;\n    }\n};\nconst stripe = getStripeInstance();\n// Log Stripe operations in development mode\nconst logStripeOperation = (operation, ...args)=>{\n    if (isDevelopment) {\n        console.log(`ðŸ”„ Stripe ${operation}:`, ...args);\n    }\n};\n// Helper function to format amount for Stripe (converts NOK to Ã¸re)\nconst formatAmountForStripe = (amount)=>{\n    return Math.round(amount * 100);\n};\n// Helper function to format amount from Stripe (converts Ã¸re to NOK)\nconst formatAmountFromStripe = (amount)=>{\n    return amount / 100;\n};\n// Create a Stripe customer\nconst createCustomer = async (email, name)=>{\n    try {\n        logStripeOperation(\"createCustomer\", {\n            email,\n            name\n        });\n        // In development mode, use test mode\n        if (isDevelopment) {\n            console.log(\"âš ï¸ Using test mode for Stripe operations\");\n            // In development, we can mock the customer creation\n            return {\n                id: \"cus_test_\" + Math.random().toString(36).substring(2, 10),\n                email,\n                name,\n                created: Math.floor(Date.now() / 1000)\n            };\n        }\n        if (!stripe) {\n            return {\n                id: \"cus_mock_\" + Math.random().toString(36).substring(2, 10),\n                email,\n                name,\n                created: Math.floor(Date.now() / 1000)\n            };\n        }\n        const customer = await stripe.customers.create({\n            email,\n            name\n        });\n        return customer;\n    } catch (error) {\n        console.error(\"Error creating Stripe customer:\", error);\n        // Return a mock customer in case of error\n        return {\n            id: \"cus_mock_error_\" + Math.random().toString(36).substring(2, 10),\n            email,\n            name,\n            created: Math.floor(Date.now() / 1000)\n        };\n    }\n};\n// Create a Stripe invoice\nconst createInvoice = async (customerId, description, amount, currency = \"nok\")=>{\n    try {\n        logStripeOperation(\"createInvoice\", {\n            customerId,\n            description,\n            amount,\n            currency\n        });\n        // In development mode or if Stripe is not initialized, mock the invoice creation\n        if (isDevelopment || !stripe) {\n            return {\n                id: \"in_test_\" + Math.random().toString(36).substring(2, 10),\n                customer: customerId,\n                amount_due: formatAmountForStripe(amount),\n                currency,\n                description,\n                status: \"open\",\n                due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n                created: Math.floor(Date.now() / 1000)\n            };\n        }\n        // Create an invoice item\n        const invoiceItem = await stripe.invoiceItems.create({\n            customer: customerId,\n            amount: formatAmountForStripe(amount),\n            currency,\n            description\n        });\n        // Create an invoice from the invoice item\n        const invoice = await stripe.invoices.create({\n            customer: customerId,\n            auto_advance: true,\n            collection_method: \"send_invoice\",\n            days_until_due: 30\n        });\n        // Finalize the invoice\n        const finalizedInvoice = await stripe.invoices.finalizeInvoice(invoice.id);\n        // Send the invoice\n        await stripe.invoices.sendInvoice(finalizedInvoice.id);\n        return finalizedInvoice;\n    } catch (error) {\n        console.error(\"Error creating Stripe invoice:\", error);\n        // Return a mock invoice in case of error\n        return {\n            id: \"in_mock_error_\" + Math.random().toString(36).substring(2, 10),\n            customer: customerId,\n            amount_due: formatAmountForStripe(amount),\n            currency,\n            description,\n            status: \"open\",\n            due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n            created: Math.floor(Date.now() / 1000)\n        };\n    }\n};\n// Get all invoices for a customer\nconst getCustomerInvoices = async (customerId)=>{\n    try {\n        logStripeOperation(\"getCustomerInvoices\", {\n            customerId\n        });\n        // If Stripe is not initialized or we're in development, return mock data\n        if (!stripe || isDevelopment) {\n            console.log(\"âš ï¸ Using mock data for customer invoices\");\n            return [\n                {\n                    id: \"in_mock_1\",\n                    number: \"MOCK001\",\n                    amount_due: 10000,\n                    currency: \"nok\",\n                    status: \"open\",\n                    due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n                    hosted_invoice_url: \"#\",\n                    created: Math.floor(Date.now() / 1000) - 86400\n                },\n                {\n                    id: \"in_mock_2\",\n                    number: \"MOCK002\",\n                    amount_due: 25000,\n                    currency: \"nok\",\n                    status: \"paid\",\n                    due_date: Math.floor(Date.now() / 1000) + 86400 * 15,\n                    hosted_invoice_url: \"#\",\n                    created: Math.floor(Date.now() / 1000) - 86400 * 7\n                }\n            ];\n        }\n        // Use real Stripe API calls\n        const invoices = await stripe.invoices.list({\n            customer: customerId,\n            limit: 100\n        });\n        return invoices.data;\n    } catch (error) {\n        console.error(\"Error fetching customer invoices:\", error);\n        // Return mock data in case of error\n        return [\n            {\n                id: \"in_mock_error_1\",\n                number: \"ERROR001\",\n                amount_due: 10000,\n                currency: \"nok\",\n                status: \"open\",\n                due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n                hosted_invoice_url: \"#\",\n                created: Math.floor(Date.now() / 1000) - 86400\n            }\n        ];\n    }\n};\n// Create a payment intent\nconst createPaymentIntent = async (amount, currency = \"nok\", customerId)=>{\n    try {\n        logStripeOperation(\"createPaymentIntent\", {\n            amount,\n            currency,\n            customerId\n        });\n        // In development mode or if Stripe is not initialized, mock the payment intent\n        if (isDevelopment || !stripe) {\n            return {\n                id: \"pi_test_\" + Math.random().toString(36).substring(2, 10),\n                amount: formatAmountForStripe(amount),\n                currency,\n                client_secret: \"pi_test_secret_\" + Math.random().toString(36).substring(2, 15),\n                customer: customerId\n            };\n        }\n        const paymentIntentParams = {\n            amount: formatAmountForStripe(amount),\n            currency,\n            automatic_payment_methods: {\n                enabled: true\n            }\n        };\n        if (customerId) {\n            paymentIntentParams.customer = customerId;\n        }\n        const paymentIntent = await stripe.paymentIntents.create(paymentIntentParams);\n        return paymentIntent;\n    } catch (error) {\n        console.error(\"Error creating payment intent:\", error);\n        // Return a mock payment intent in case of error\n        return {\n            id: \"pi_mock_error_\" + Math.random().toString(36).substring(2, 10),\n            amount: formatAmountForStripe(amount),\n            currency,\n            client_secret: \"pi_mock_error_secret_\" + Math.random().toString(36).substring(2, 15),\n            customer: customerId\n        };\n    }\n};\n// Pay an invoice\nconst payInvoice = async (invoiceId)=>{\n    try {\n        logStripeOperation(\"payInvoice\", {\n            invoiceId\n        });\n        // In development mode or if Stripe is not initialized, mock the invoice payment\n        if (isDevelopment || !stripe) {\n            return {\n                id: invoiceId,\n                status: \"paid\",\n                paid: true,\n                amount_paid: 10000,\n                currency: \"nok\"\n            };\n        }\n        const invoice = await stripe.invoices.pay(invoiceId);\n        return invoice;\n    } catch (error) {\n        console.error(\"Error paying invoice:\", error);\n        // Return a mock paid invoice in case of error\n        return {\n            id: invoiceId,\n            status: \"paid\",\n            paid: true,\n            amount_paid: 10000,\n            currency: \"nok\"\n        };\n    }\n};\n// Create a test invoice (for development only)\nconst createTestInvoice = async (customerId)=>{\n    // Only allow this in development mode\n    if (!isDevelopment) {\n        throw new Error(\"Test invoices can only be created in development mode\");\n    }\n    if (!customerId) {\n        throw new Error(\"Customer ID is required to create a test invoice\");\n    }\n    try {\n        logStripeOperation(\"createTestInvoice\", {\n            customerId\n        });\n        // Generate a random amount between 100 and 1000 NOK\n        const amount = Math.floor(Math.random() * 900) + 100;\n        // In development mode or if Stripe is not initialized, return a mock invoice\n        if (isDevelopment || !stripe) {\n            return {\n                id: \"in_test_\" + Math.random().toString(36).substring(2, 10),\n                number: \"TEST\" + Math.floor(Math.random() * 10000),\n                customer: customerId,\n                amount_due: formatAmountForStripe(amount),\n                currency: \"nok\",\n                description: \"Test Invoice - Development Only\",\n                status: \"open\",\n                due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n                created: Math.floor(Date.now() / 1000)\n            };\n        }\n        // The code below will only run if isDevelopment is false, which won't happen due to the check at the beginning\n        // But we'll keep it for completeness\n        // Create an invoice item\n        const invoiceItem = await stripe.invoiceItems.create({\n            customer: customerId,\n            amount: formatAmountForStripe(amount),\n            currency: \"nok\",\n            description: \"Test Invoice - Development Only\"\n        });\n        logStripeOperation(\"invoiceItem created\", invoiceItem);\n        // Create an invoice from the invoice item\n        const invoice = await stripe.invoices.create({\n            customer: customerId,\n            auto_advance: true,\n            collection_method: \"send_invoice\",\n            days_until_due: 30\n        });\n        logStripeOperation(\"invoice created\", invoice);\n        // Finalize the invoice\n        const finalizedInvoice = await stripe.invoices.finalizeInvoice(invoice.id);\n        logStripeOperation(\"invoice finalized\", finalizedInvoice);\n        return finalizedInvoice;\n    } catch (error) {\n        console.error(\"Error creating test invoice:\", error);\n        // Return a mock invoice in case of error\n        return {\n            id: \"in_mock_error_\" + Math.random().toString(36).substring(2, 10),\n            number: \"ERROR\" + Math.floor(Math.random() * 10000),\n            customer: customerId,\n            amount_due: formatAmountForStripe(Math.floor(Math.random() * 900) + 100),\n            currency: \"nok\",\n            description: \"Test Invoice - Development Only\",\n            status: \"open\",\n            due_date: Math.floor(Date.now() / 1000) + 86400 * 30,\n            created: Math.floor(Date.now() / 1000)\n        };\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxPQUFPO1lBQ3BFYSxVQUFVO1lBQ1ZELGFBQWE7WUFDYkcsUUFBUTtZQUNSQyxVQUFVdkIsS0FBS1csS0FBSyxDQUFDQyxLQUFLQyxHQUFHLEtBQUssUUFBUSxRQUFRO1lBQ2xESCxTQUFTVixLQUFLVyxLQUFLLENBQUNDLEtBQUtDLEdBQUcsS0FBSztRQUNuQztJQUNGO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2hlcHRhLWRhc2hib2FyZC8uL2xpYi9zdHJpcGUudHM/MGUzMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RyaXBlIGZyb20gXCJzdHJpcGVcIlxuXG4vLyBDaGVjayBpZiB3ZSdyZSBpbiBkZXZlbG9wbWVudCBtb2RlXG5jb25zdCBpc0RldmVsb3BtZW50ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIlxuXG4vLyBJbml0aWFsaXplIFN0cmlwZSB3aXRoIHRoZSBwcm92aWRlZCBzZWNyZXQga2V5XG4vLyBVc2UgYSB0ZXN0IGtleSBmb3IgZGV2ZWxvcG1lbnQgYW5kIGhhbmRsZSBtaXNzaW5nIGtleXMgZ3JhY2VmdWxseVxuY29uc3QgZ2V0U3RyaXBlSW5zdGFuY2UgPSAoKSA9PiB7XG4gIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NUUklQRV9TRUNSRVRfS0VZXG5cbiAgaWYgKCFhcGlLZXkpIHtcbiAgICBjb25zb2xlLndhcm4oXCLimqDvuI8gTm8gU3RyaXBlIEFQSSBrZXkgZm91bmQuIFVzaW5nIG1vY2sgZGF0YSBmb3IgU3RyaXBlIG9wZXJhdGlvbnMuXCIpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHdlJ3JlIHRyeWluZyB0byB1c2UgYSBsaXZlIGtleSBpbiBkZXZlbG9wbWVudFxuICBpZiAoaXNEZXZlbG9wbWVudCAmJiBhcGlLZXkuc3RhcnRzV2l0aChcInNrX2xpdmVfXCIpKSB7XG4gICAgY29uc29sZS53YXJuKFwi4pqg77iPIFVzaW5nIGEgbGl2ZSBTdHJpcGUga2V5IGluIGRldmVsb3BtZW50IGVudmlyb25tZW50LiBDb25zaWRlciB1c2luZyBhIHRlc3Qga2V5IGluc3RlYWQuXCIpXG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiBuZXcgU3RyaXBlKGFwaUtleSwge1xuICAgICAgYXBpVmVyc2lvbjogXCIyMDIzLTEwLTE2XCIsIC8vIFVzZSB0aGUgbGF0ZXN0IEFQSSB2ZXJzaW9uXG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgU3RyaXBlOlwiLCBlcnJvcilcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzdHJpcGUgPSBnZXRTdHJpcGVJbnN0YW5jZSgpXG5cbi8vIExvZyBTdHJpcGUgb3BlcmF0aW9ucyBpbiBkZXZlbG9wbWVudCBtb2RlXG5jb25zdCBsb2dTdHJpcGVPcGVyYXRpb24gPSAob3BlcmF0aW9uOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gIGlmIChpc0RldmVsb3BtZW50KSB7XG4gICAgY29uc29sZS5sb2coYPCflIQgU3RyaXBlICR7b3BlcmF0aW9ufTpgLCAuLi5hcmdzKVxuICB9XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBmb3JtYXQgYW1vdW50IGZvciBTdHJpcGUgKGNvbnZlcnRzIE5PSyB0byDDuHJlKVxuZXhwb3J0IGNvbnN0IGZvcm1hdEFtb3VudEZvclN0cmlwZSA9IChhbW91bnQ6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIHJldHVybiBNYXRoLnJvdW5kKGFtb3VudCAqIDEwMClcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGZvcm1hdCBhbW91bnQgZnJvbSBTdHJpcGUgKGNvbnZlcnRzIMO4cmUgdG8gTk9LKVxuZXhwb3J0IGNvbnN0IGZvcm1hdEFtb3VudEZyb21TdHJpcGUgPSAoYW1vdW50OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICByZXR1cm4gYW1vdW50IC8gMTAwXG59XG5cbi8vIENyZWF0ZSBhIFN0cmlwZSBjdXN0b21lclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUN1c3RvbWVyID0gYXN5bmMgKGVtYWlsOiBzdHJpbmcsIG5hbWU/OiBzdHJpbmcpID0+IHtcbiAgdHJ5IHtcbiAgICBsb2dTdHJpcGVPcGVyYXRpb24oXCJjcmVhdGVDdXN0b21lclwiLCB7IGVtYWlsLCBuYW1lIH0pXG5cbiAgICAvLyBJbiBkZXZlbG9wbWVudCBtb2RlLCB1c2UgdGVzdCBtb2RlXG4gICAgaWYgKGlzRGV2ZWxvcG1lbnQpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIFVzaW5nIHRlc3QgbW9kZSBmb3IgU3RyaXBlIG9wZXJhdGlvbnNcIilcblxuICAgICAgLy8gSW4gZGV2ZWxvcG1lbnQsIHdlIGNhbiBtb2NrIHRoZSBjdXN0b21lciBjcmVhdGlvblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IFwiY3VzX3Rlc3RfXCIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgMTApLFxuICAgICAgICBlbWFpbCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgY3JlYXRlZDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzdHJpcGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBcImN1c19tb2NrX1wiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDEwKSxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGNyZWF0ZWQ6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApLFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy5jcmVhdGUoe1xuICAgICAgZW1haWwsXG4gICAgICBuYW1lLFxuICAgIH0pXG4gICAgcmV0dXJuIGN1c3RvbWVyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIFN0cmlwZSBjdXN0b21lcjpcIiwgZXJyb3IpXG4gICAgLy8gUmV0dXJuIGEgbW9jayBjdXN0b21lciBpbiBjYXNlIG9mIGVycm9yXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBcImN1c19tb2NrX2Vycm9yX1wiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDEwKSxcbiAgICAgIGVtYWlsLFxuICAgICAgbmFtZSxcbiAgICAgIGNyZWF0ZWQ6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApLFxuICAgIH1cbiAgfVxufVxuXG4vLyBDcmVhdGUgYSBTdHJpcGUgaW52b2ljZVxuZXhwb3J0IGNvbnN0IGNyZWF0ZUludm9pY2UgPSBhc3luYyAoY3VzdG9tZXJJZDogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBhbW91bnQ6IG51bWJlciwgY3VycmVuY3kgPSBcIm5va1wiKSA9PiB7XG4gIHRyeSB7XG4gICAgbG9nU3RyaXBlT3BlcmF0aW9uKFwiY3JlYXRlSW52b2ljZVwiLCB7IGN1c3RvbWVySWQsIGRlc2NyaXB0aW9uLCBhbW91bnQsIGN1cnJlbmN5IH0pXG5cbiAgICAvLyBJbiBkZXZlbG9wbWVudCBtb2RlIG9yIGlmIFN0cmlwZSBpcyBub3QgaW5pdGlhbGl6ZWQsIG1vY2sgdGhlIGludm9pY2UgY3JlYXRpb25cbiAgICBpZiAoaXNEZXZlbG9wbWVudCB8fCAhc3RyaXBlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogXCJpbl90ZXN0X1wiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDEwKSxcbiAgICAgICAgY3VzdG9tZXI6IGN1c3RvbWVySWQsXG4gICAgICAgIGFtb3VudF9kdWU6IGZvcm1hdEFtb3VudEZvclN0cmlwZShhbW91bnQpLFxuICAgICAgICBjdXJyZW5jeSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHN0YXR1czogXCJvcGVuXCIsXG4gICAgICAgIGR1ZV9kYXRlOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDg2NDAwICogMzAsIC8vIDMwIGRheXMgZnJvbSBub3dcbiAgICAgICAgY3JlYXRlZDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFuIGludm9pY2UgaXRlbVxuICAgIGNvbnN0IGludm9pY2VJdGVtID0gYXdhaXQgc3RyaXBlLmludm9pY2VJdGVtcy5jcmVhdGUoe1xuICAgICAgY3VzdG9tZXI6IGN1c3RvbWVySWQsXG4gICAgICBhbW91bnQ6IGZvcm1hdEFtb3VudEZvclN0cmlwZShhbW91bnQpLFxuICAgICAgY3VycmVuY3ksXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICB9KVxuXG4gICAgLy8gQ3JlYXRlIGFuIGludm9pY2UgZnJvbSB0aGUgaW52b2ljZSBpdGVtXG4gICAgY29uc3QgaW52b2ljZSA9IGF3YWl0IHN0cmlwZS5pbnZvaWNlcy5jcmVhdGUoe1xuICAgICAgY3VzdG9tZXI6IGN1c3RvbWVySWQsXG4gICAgICBhdXRvX2FkdmFuY2U6IHRydWUsIC8vIEF1dG8tZmluYWxpemUgdGhlIGludm9pY2VcbiAgICAgIGNvbGxlY3Rpb25fbWV0aG9kOiBcInNlbmRfaW52b2ljZVwiLFxuICAgICAgZGF5c191bnRpbF9kdWU6IDMwLFxuICAgIH0pXG5cbiAgICAvLyBGaW5hbGl6ZSB0aGUgaW52b2ljZVxuICAgIGNvbnN0IGZpbmFsaXplZEludm9pY2UgPSBhd2FpdCBzdHJpcGUuaW52b2ljZXMuZmluYWxpemVJbnZvaWNlKGludm9pY2UuaWQpXG5cbiAgICAvLyBTZW5kIHRoZSBpbnZvaWNlXG4gICAgYXdhaXQgc3RyaXBlLmludm9pY2VzLnNlbmRJbnZvaWNlKGZpbmFsaXplZEludm9pY2UuaWQpXG5cbiAgICByZXR1cm4gZmluYWxpemVkSW52b2ljZVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBTdHJpcGUgaW52b2ljZTpcIiwgZXJyb3IpXG4gICAgLy8gUmV0dXJuIGEgbW9jayBpbnZvaWNlIGluIGNhc2Ugb2YgZXJyb3JcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IFwiaW5fbW9ja19lcnJvcl9cIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMCksXG4gICAgICBjdXN0b21lcjogY3VzdG9tZXJJZCxcbiAgICAgIGFtb3VudF9kdWU6IGZvcm1hdEFtb3VudEZvclN0cmlwZShhbW91bnQpLFxuICAgICAgY3VycmVuY3ksXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIHN0YXR1czogXCJvcGVuXCIsXG4gICAgICBkdWVfZGF0ZTogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyA4NjQwMCAqIDMwLFxuICAgICAgY3JlYXRlZDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXG4gICAgfVxuICB9XG59XG5cbi8vIEdldCBhbGwgaW52b2ljZXMgZm9yIGEgY3VzdG9tZXJcbmV4cG9ydCBjb25zdCBnZXRDdXN0b21lckludm9pY2VzID0gYXN5bmMgKGN1c3RvbWVySWQ6IHN0cmluZykgPT4ge1xuICB0cnkge1xuICAgIGxvZ1N0cmlwZU9wZXJhdGlvbihcImdldEN1c3RvbWVySW52b2ljZXNcIiwgeyBjdXN0b21lcklkIH0pXG5cbiAgICAvLyBJZiBTdHJpcGUgaXMgbm90IGluaXRpYWxpemVkIG9yIHdlJ3JlIGluIGRldmVsb3BtZW50LCByZXR1cm4gbW9jayBkYXRhXG4gICAgaWYgKCFzdHJpcGUgfHwgaXNEZXZlbG9wbWVudCkge1xuICAgICAgY29uc29sZS5sb2coXCLimqDvuI8gVXNpbmcgbW9jayBkYXRhIGZvciBjdXN0b21lciBpbnZvaWNlc1wiKVxuICAgICAgcmV0dXJuIFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBcImluX21vY2tfMVwiLFxuICAgICAgICAgIG51bWJlcjogXCJNT0NLMDAxXCIsXG4gICAgICAgICAgYW1vdW50X2R1ZTogMTAwMDAsIC8vIDEwMC4wMCBpbiBjZW50c1xuICAgICAgICAgIGN1cnJlbmN5OiBcIm5va1wiLFxuICAgICAgICAgIHN0YXR1czogXCJvcGVuXCIsXG4gICAgICAgICAgZHVlX2RhdGU6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgODY0MDAgKiAzMCwgLy8gMzAgZGF5cyBmcm9tIG5vd1xuICAgICAgICAgIGhvc3RlZF9pbnZvaWNlX3VybDogXCIjXCIsXG4gICAgICAgICAgY3JlYXRlZDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgLSA4NjQwMCwgLy8gMSBkYXkgYWdvXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogXCJpbl9tb2NrXzJcIixcbiAgICAgICAgICBudW1iZXI6IFwiTU9DSzAwMlwiLFxuICAgICAgICAgIGFtb3VudF9kdWU6IDI1MDAwLCAvLyAyNTAuMDAgaW4gY2VudHNcbiAgICAgICAgICBjdXJyZW5jeTogXCJub2tcIixcbiAgICAgICAgICBzdGF0dXM6IFwicGFpZFwiLFxuICAgICAgICAgIGR1ZV9kYXRlOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDg2NDAwICogMTUsIC8vIDE1IGRheXMgZnJvbSBub3dcbiAgICAgICAgICBob3N0ZWRfaW52b2ljZV91cmw6IFwiI1wiLFxuICAgICAgICAgIGNyZWF0ZWQ6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApIC0gODY0MDAgKiA3LCAvLyA3IGRheXMgYWdvXG4gICAgICAgIH0sXG4gICAgICBdXG4gICAgfVxuXG4gICAgLy8gVXNlIHJlYWwgU3RyaXBlIEFQSSBjYWxsc1xuICAgIGNvbnN0IGludm9pY2VzID0gYXdhaXQgc3RyaXBlLmludm9pY2VzLmxpc3Qoe1xuICAgICAgY3VzdG9tZXI6IGN1c3RvbWVySWQsXG4gICAgICBsaW1pdDogMTAwLFxuICAgIH0pXG4gICAgcmV0dXJuIGludm9pY2VzLmRhdGFcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgY3VzdG9tZXIgaW52b2ljZXM6XCIsIGVycm9yKVxuICAgIC8vIFJldHVybiBtb2NrIGRhdGEgaW4gY2FzZSBvZiBlcnJvclxuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIGlkOiBcImluX21vY2tfZXJyb3JfMVwiLFxuICAgICAgICBudW1iZXI6IFwiRVJST1IwMDFcIixcbiAgICAgICAgYW1vdW50X2R1ZTogMTAwMDAsXG4gICAgICAgIGN1cnJlbmN5OiBcIm5va1wiLFxuICAgICAgICBzdGF0dXM6IFwib3BlblwiLFxuICAgICAgICBkdWVfZGF0ZTogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyA4NjQwMCAqIDMwLFxuICAgICAgICBob3N0ZWRfaW52b2ljZV91cmw6IFwiI1wiLFxuICAgICAgICBjcmVhdGVkOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAtIDg2NDAwLFxuICAgICAgfSxcbiAgICBdXG4gIH1cbn1cblxuLy8gQ3JlYXRlIGEgcGF5bWVudCBpbnRlbnRcbmV4cG9ydCBjb25zdCBjcmVhdGVQYXltZW50SW50ZW50ID0gYXN5bmMgKGFtb3VudDogbnVtYmVyLCBjdXJyZW5jeSA9IFwibm9rXCIsIGN1c3RvbWVySWQ/OiBzdHJpbmcpID0+IHtcbiAgdHJ5IHtcbiAgICBsb2dTdHJpcGVPcGVyYXRpb24oXCJjcmVhdGVQYXltZW50SW50ZW50XCIsIHsgYW1vdW50LCBjdXJyZW5jeSwgY3VzdG9tZXJJZCB9KVxuXG4gICAgLy8gSW4gZGV2ZWxvcG1lbnQgbW9kZSBvciBpZiBTdHJpcGUgaXMgbm90IGluaXRpYWxpemVkLCBtb2NrIHRoZSBwYXltZW50IGludGVudFxuICAgIGlmIChpc0RldmVsb3BtZW50IHx8ICFzdHJpcGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBcInBpX3Rlc3RfXCIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgMTApLFxuICAgICAgICBhbW91bnQ6IGZvcm1hdEFtb3VudEZvclN0cmlwZShhbW91bnQpLFxuICAgICAgICBjdXJyZW5jeSxcbiAgICAgICAgY2xpZW50X3NlY3JldDogXCJwaV90ZXN0X3NlY3JldF9cIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSksXG4gICAgICAgIGN1c3RvbWVyOiBjdXN0b21lcklkLFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHBheW1lbnRJbnRlbnRQYXJhbXM6IFN0cmlwZS5QYXltZW50SW50ZW50Q3JlYXRlUGFyYW1zID0ge1xuICAgICAgYW1vdW50OiBmb3JtYXRBbW91bnRGb3JTdHJpcGUoYW1vdW50KSxcbiAgICAgIGN1cnJlbmN5LFxuICAgICAgYXV0b21hdGljX3BheW1lbnRfbWV0aG9kczoge1xuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgfSxcbiAgICB9XG5cbiAgICBpZiAoY3VzdG9tZXJJZCkge1xuICAgICAgcGF5bWVudEludGVudFBhcmFtcy5jdXN0b21lciA9IGN1c3RvbWVySWRcbiAgICB9XG5cbiAgICBjb25zdCBwYXltZW50SW50ZW50ID0gYXdhaXQgc3RyaXBlLnBheW1lbnRJbnRlbnRzLmNyZWF0ZShwYXltZW50SW50ZW50UGFyYW1zKVxuICAgIHJldHVybiBwYXltZW50SW50ZW50XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIHBheW1lbnQgaW50ZW50OlwiLCBlcnJvcilcbiAgICAvLyBSZXR1cm4gYSBtb2NrIHBheW1lbnQgaW50ZW50IGluIGNhc2Ugb2YgZXJyb3JcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IFwicGlfbW9ja19lcnJvcl9cIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMCksXG4gICAgICBhbW91bnQ6IGZvcm1hdEFtb3VudEZvclN0cmlwZShhbW91bnQpLFxuICAgICAgY3VycmVuY3ksXG4gICAgICBjbGllbnRfc2VjcmV0OiBcInBpX21vY2tfZXJyb3Jfc2VjcmV0X1wiICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KSxcbiAgICAgIGN1c3RvbWVyOiBjdXN0b21lcklkLFxuICAgIH1cbiAgfVxufVxuXG4vLyBQYXkgYW4gaW52b2ljZVxuZXhwb3J0IGNvbnN0IHBheUludm9pY2UgPSBhc3luYyAoaW52b2ljZUlkOiBzdHJpbmcpID0+IHtcbiAgdHJ5IHtcbiAgICBsb2dTdHJpcGVPcGVyYXRpb24oXCJwYXlJbnZvaWNlXCIsIHsgaW52b2ljZUlkIH0pXG5cbiAgICAvLyBJbiBkZXZlbG9wbWVudCBtb2RlIG9yIGlmIFN0cmlwZSBpcyBub3QgaW5pdGlhbGl6ZWQsIG1vY2sgdGhlIGludm9pY2UgcGF5bWVudFxuICAgIGlmIChpc0RldmVsb3BtZW50IHx8ICFzdHJpcGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBpbnZvaWNlSWQsXG4gICAgICAgIHN0YXR1czogXCJwYWlkXCIsXG4gICAgICAgIHBhaWQ6IHRydWUsXG4gICAgICAgIGFtb3VudF9wYWlkOiAxMDAwMCwgLy8gRXhhbXBsZSBhbW91bnRcbiAgICAgICAgY3VycmVuY3k6IFwibm9rXCIsXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaW52b2ljZSA9IGF3YWl0IHN0cmlwZS5pbnZvaWNlcy5wYXkoaW52b2ljZUlkKVxuICAgIHJldHVybiBpbnZvaWNlXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHBheWluZyBpbnZvaWNlOlwiLCBlcnJvcilcbiAgICAvLyBSZXR1cm4gYSBtb2NrIHBhaWQgaW52b2ljZSBpbiBjYXNlIG9mIGVycm9yXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBpbnZvaWNlSWQsXG4gICAgICBzdGF0dXM6IFwicGFpZFwiLFxuICAgICAgcGFpZDogdHJ1ZSxcbiAgICAgIGFtb3VudF9wYWlkOiAxMDAwMCxcbiAgICAgIGN1cnJlbmN5OiBcIm5va1wiLFxuICAgIH1cbiAgfVxufVxuXG4vLyBDcmVhdGUgYSB0ZXN0IGludm9pY2UgKGZvciBkZXZlbG9wbWVudCBvbmx5KVxuZXhwb3J0IGNvbnN0IGNyZWF0ZVRlc3RJbnZvaWNlID0gYXN5bmMgKGN1c3RvbWVySWQ6IHN0cmluZykgPT4ge1xuICAvLyBPbmx5IGFsbG93IHRoaXMgaW4gZGV2ZWxvcG1lbnQgbW9kZVxuICBpZiAoIWlzRGV2ZWxvcG1lbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUZXN0IGludm9pY2VzIGNhbiBvbmx5IGJlIGNyZWF0ZWQgaW4gZGV2ZWxvcG1lbnQgbW9kZVwiKVxuICB9XG5cbiAgaWYgKCFjdXN0b21lcklkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ3VzdG9tZXIgSUQgaXMgcmVxdWlyZWQgdG8gY3JlYXRlIGEgdGVzdCBpbnZvaWNlXCIpXG4gIH1cblxuICB0cnkge1xuICAgIGxvZ1N0cmlwZU9wZXJhdGlvbihcImNyZWF0ZVRlc3RJbnZvaWNlXCIsIHsgY3VzdG9tZXJJZCB9KVxuXG4gICAgLy8gR2VuZXJhdGUgYSByYW5kb20gYW1vdW50IGJldHdlZW4gMTAwIGFuZCAxMDAwIE5PS1xuICAgIGNvbnN0IGFtb3VudCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkwMCkgKyAxMDBcblxuICAgIC8vIEluIGRldmVsb3BtZW50IG1vZGUgb3IgaWYgU3RyaXBlIGlzIG5vdCBpbml0aWFsaXplZCwgcmV0dXJuIGEgbW9jayBpbnZvaWNlXG4gICAgaWYgKGlzRGV2ZWxvcG1lbnQgfHwgIXN0cmlwZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IFwiaW5fdGVzdF9cIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMCksXG4gICAgICAgIG51bWJlcjogXCJURVNUXCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCksXG4gICAgICAgIGN1c3RvbWVyOiBjdXN0b21lcklkLFxuICAgICAgICBhbW91bnRfZHVlOiBmb3JtYXRBbW91bnRGb3JTdHJpcGUoYW1vdW50KSxcbiAgICAgICAgY3VycmVuY3k6IFwibm9rXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRlc3QgSW52b2ljZSAtIERldmVsb3BtZW50IE9ubHlcIixcbiAgICAgICAgc3RhdHVzOiBcIm9wZW5cIixcbiAgICAgICAgZHVlX2RhdGU6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgODY0MDAgKiAzMCwgLy8gMzAgZGF5cyBmcm9tIG5vd1xuICAgICAgICBjcmVhdGVkOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSxcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUaGUgY29kZSBiZWxvdyB3aWxsIG9ubHkgcnVuIGlmIGlzRGV2ZWxvcG1lbnQgaXMgZmFsc2UsIHdoaWNoIHdvbid0IGhhcHBlbiBkdWUgdG8gdGhlIGNoZWNrIGF0IHRoZSBiZWdpbm5pbmdcbiAgICAvLyBCdXQgd2UnbGwga2VlcCBpdCBmb3IgY29tcGxldGVuZXNzXG5cbiAgICAvLyBDcmVhdGUgYW4gaW52b2ljZSBpdGVtXG4gICAgY29uc3QgaW52b2ljZUl0ZW0gPSBhd2FpdCBzdHJpcGUuaW52b2ljZUl0ZW1zLmNyZWF0ZSh7XG4gICAgICBjdXN0b21lcjogY3VzdG9tZXJJZCxcbiAgICAgIGFtb3VudDogZm9ybWF0QW1vdW50Rm9yU3RyaXBlKGFtb3VudCksXG4gICAgICBjdXJyZW5jeTogXCJub2tcIixcbiAgICAgIGRlc2NyaXB0aW9uOiBcIlRlc3QgSW52b2ljZSAtIERldmVsb3BtZW50IE9ubHlcIixcbiAgICB9KVxuXG4gICAgbG9nU3RyaXBlT3BlcmF0aW9uKFwiaW52b2ljZUl0ZW0gY3JlYXRlZFwiLCBpbnZvaWNlSXRlbSlcblxuICAgIC8vIENyZWF0ZSBhbiBpbnZvaWNlIGZyb20gdGhlIGludm9pY2UgaXRlbVxuICAgIGNvbnN0IGludm9pY2UgPSBhd2FpdCBzdHJpcGUuaW52b2ljZXMuY3JlYXRlKHtcbiAgICAgIGN1c3RvbWVyOiBjdXN0b21lcklkLFxuICAgICAgYXV0b19hZHZhbmNlOiB0cnVlLFxuICAgICAgY29sbGVjdGlvbl9tZXRob2Q6IFwic2VuZF9pbnZvaWNlXCIsXG4gICAgICBkYXlzX3VudGlsX2R1ZTogMzAsXG4gICAgfSlcblxuICAgIGxvZ1N0cmlwZU9wZXJhdGlvbihcImludm9pY2UgY3JlYXRlZFwiLCBpbnZvaWNlKVxuXG4gICAgLy8gRmluYWxpemUgdGhlIGludm9pY2VcbiAgICBjb25zdCBmaW5hbGl6ZWRJbnZvaWNlID0gYXdhaXQgc3RyaXBlLmludm9pY2VzLmZpbmFsaXplSW52b2ljZShpbnZvaWNlLmlkKVxuXG4gICAgbG9nU3RyaXBlT3BlcmF0aW9uKFwiaW52b2ljZSBmaW5hbGl6ZWRcIiwgZmluYWxpemVkSW52b2ljZSlcblxuICAgIHJldHVybiBmaW5hbGl6ZWRJbnZvaWNlXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIHRlc3QgaW52b2ljZTpcIiwgZXJyb3IpXG4gICAgLy8gUmV0dXJuIGEgbW9jayBpbnZvaWNlIGluIGNhc2Ugb2YgZXJyb3JcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IFwiaW5fbW9ja19lcnJvcl9cIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMCksXG4gICAgICBudW1iZXI6IFwiRVJST1JcIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKSxcbiAgICAgIGN1c3RvbWVyOiBjdXN0b21lcklkLFxuICAgICAgYW1vdW50X2R1ZTogZm9ybWF0QW1vdW50Rm9yU3RyaXBlKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkwMCkgKyAxMDApLFxuICAgICAgY3VycmVuY3k6IFwibm9rXCIsXG4gICAgICBkZXNjcmlwdGlvbjogXCJUZXN0IEludm9pY2UgLSBEZXZlbG9wbWVudCBPbmx5XCIsXG4gICAgICBzdGF0dXM6IFwib3BlblwiLFxuICAgICAgZHVlX2RhdGU6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgODY0MDAgKiAzMCxcbiAgICAgIGNyZWF0ZWQ6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApLFxuICAgIH1cbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiU3RyaXBlIiwiaXNEZXZlbG9wbWVudCIsInByb2Nlc3MiLCJnZXRTdHJpcGVJbnN0YW5jZSIsImFwaUtleSIsImVudiIsIlNUUklQRV9TRUNSRVRfS0VZIiwiTkVYVF9QVUJMSUNfU1RSSVBFX1NFQ1JFVF9LRVkiLCJjb25zb2xlIiwid2FybiIsInN0YXJ0c1dpdGgiLCJhcGlWZXJzaW9uIiwiZXJyb3IiLCJzdHJpcGUiLCJsb2dTdHJpcGVPcGVyYXRpb24iLCJvcGVyYXRpb24iLCJhcmdzIiwibG9nIiwiZm9ybWF0QW1vdW50Rm9yU3RyaXBlIiwiYW1vdW50IiwiTWF0aCIsInJvdW5kIiwiZm9ybWF0QW1vdW50RnJvbVN0cmlwZSIsImNyZWF0ZUN1c3RvbWVyIiwiZW1haWwiLCJuYW1lIiwiaWQiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImNyZWF0ZWQiLCJmbG9vciIsIkRhdGUiLCJub3ciLCJjdXN0b21lciIsImN1c3RvbWVycyIsImNyZWF0ZSIsImNyZWF0ZUludm9pY2UiLCJjdXN0b21lcklkIiwiZGVzY3JpcHRpb24iLCJjdXJyZW5jeSIsImFtb3VudF9kdWUiLCJzdGF0dXMiLCJkdWVfZGF0ZSIsImludm9pY2VJdGVtIiwiaW52b2ljZUl0ZW1zIiwiaW52b2ljZSIsImludm9pY2VzIiwiYXV0b19hZHZhbmNlIiwiY29sbGVjdGlvbl9tZXRob2QiLCJkYXlzX3VudGlsX2R1ZSIsImZpbmFsaXplZEludm9pY2UiLCJmaW5hbGl6ZUludm9pY2UiLCJzZW5kSW52b2ljZSIsImdldEN1c3RvbWVySW52b2ljZXMiLCJudW1iZXIiLCJob3N0ZWRfaW52b2ljZV91cmwiLCJsaXN0IiwibGltaXQiLCJkYXRhIiwiY3JlYXRlUGF5bWVudEludGVudCIsImNsaWVudF9zZWNyZXQiLCJwYXltZW50SW50ZW50UGFyYW1zIiwiYXV0b21hdGljX3BheW1lbnRfbWV0aG9kcyIsImVuYWJsZWQiLCJwYXltZW50SW50ZW50IiwicGF5bWVudEludGVudHMiLCJwYXlJbnZvaWNlIiwiaW52b2ljZUlkIiwicGFpZCIsImFtb3VudF9wYWlkIiwicGF5IiwiY3JlYXRlVGVzdEludm9pY2UiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stripe.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/set-cookie-parser","vendor-chunks/webidl-conversions","vendor-chunks/jose","vendor-chunks/stripe","vendor-chunks/qs","vendor-chunks/object-inspect","vendor-chunks/get-intrinsic","vendor-chunks/side-channel-list","vendor-chunks/side-channel-weakmap","vendor-chunks/has-symbols","vendor-chunks/function-bind","vendor-chunks/side-channel-map","vendor-chunks/side-channel","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/dunder-proto","vendor-chunks/math-intrinsics","vendor-chunks/call-bound","vendor-chunks/es-errors","vendor-chunks/gopd","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&page=%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstripe%2Fcreate-customer-for-user%2Froute.ts&appDir=%2Fhome%2Fruben%2Fcode%2Fhepta%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fruben%2Fcode%2Fhepta&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();